<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Supply Chain Command Center</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

    <!-- CDN Libraries (No NPM needed) -->
    <script src="https://unpkg.com/enigma.js@2.4.0/enigma.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div class="app-container">
        <!-- SIDEBAR -->
        <aside class="sidebar">
            <div class="brand-section">
                <span>ðŸ“¦</span> Qlik Analytical
            </div>
            <nav class="nav-links">
                <div class="nav-link active" id="nav-overview">
                    <span>ðŸ“Š</span> Overview
                </div>
                <div class="nav-link" id="nav-sales">
                    <span>ðŸ’°</span> Sales Trends
                </div>
                <div class="nav-link" id="nav-shipping">
                    <span>ðŸšš</span> Shipping
                </div>
                <div class="nav-link" id="nav-products">
                    <span>ðŸ“¦</span> Products
                </div>
            </nav>
            <div class="sidebar-footer">
                <div style="font-size:10px; opacity:0.7;">v3.0.0 Real-time Data</div>
                <!-- LOG CONTAINER -->
                <div id="ui-log"
                    style="font-family:monospace; font-size:10px; color:#aaa; margin-top:10px; max-height:100px; overflow-y:auto; word-break:break-all;">
                </div>
            </div>
        </aside>

        <!-- MAIN CONTENT -->
        <main class="main-content">
            <!-- HEADER -->
            <header class="top-header">
                <div class="page-title">
                    <h1 id="page-heading">Overview</h1>
                    <p>Supply Chain Key Performance Indicators</p>
                </div>
                <div class="header-actions">
                    <!-- QLIK SELECTIONS BAR -->
                    <div style="display:flex; gap:10px; align-items:center;">
                        <span style="font-size:12px; font-weight:600; color:#555;">FILTERS:</span>
                        <div class="selection-pill" onclick="document.getElementById('btn-west').click()"
                            style="cursor:pointer; background:#e0e0e0; padding:4px 8px; border-radius:4px; font-size:12px;">
                            Region: West
                        </div>
                        <div class="selection-pill" onclick="document.getElementById('btn-east').click()"
                            style="cursor:pointer; background:#e0e0e0; padding:4px 8px; border-radius:4px; font-size:12px;">
                            Region: East
                        </div>
                        <div class="selection-pill" onclick="document.getElementById('btn-clear').click()"
                            style="cursor:pointer; background:#fff; border:1px solid #ccc; padding:4px 8px; border-radius:4px; font-size:12px;">
                            Clear
                        </div>
                    </div>
                    <!-- Hidden Logic Buttons -->
                    <div style="display:none;">
                        <button id="btn-west">W</button>
                        <button id="btn-east">E</button>
                        <button id="btn-clear">C</button>
                    </div>
                </div>
            </header>

            <!-- STATUS STRIP -->
            <div class="connection-bar">
                <div class="status-indicator">
                    <div class="dot" id="dot-status"></div>
                    <span id="txt-status">Connecting to Engine...</span>
                </div>
                <div style="margin-left:auto; font-size:11px; color:#aaa;">Last Updated: Just Now</div>
            </div>

            <!-- DASHBOARD GRID CONTAINER -->
            <div class="dashboard-scroll">

                <!-- VIEW 1: EXECUTIVE (Default) -->
                <!-- 1. OVERVIEW VIEW -->
                <div id="view-overview" class="view-section">
                    <!-- KPIs -->
                    <div class="dashboard-grid kpi-row">
                        <div class="card span-1 h-kpi">
                            <div class="card-title">Revenue</div>
                            <div class="metric-value" id="kpi-sales">--</div>
                            <div class="card-footer">Total Sales</div>
                        </div>
                        <div class="card span-1 h-kpi">
                            <div class="card-title">Margin %</div>
                            <div class="metric-value" id="kpi-margin">--</div>
                            <div class="card-footer">Profitability</div>
                        </div>
                        <div class="card span-1 h-kpi">
                            <div class="card-title">Cost Ratio</div>
                            <div class="metric-value" id="kpi-otif">--</div>
                            <div class="card-footer">Logistics Impact</div>
                        </div>
                        <div class="card span-1 h-kpi">
                            <div class="card-title">Avg Discount</div>
                            <div class="metric-value" id="kpi-orders">--</div>
                            <div class="card-footer">Pricing Discipline</div>
                        </div>
                    </div>
                    <!-- Overview Charts -->
                    <div class="dashboard-grid">
                        <div class="card span-2 h-chart">
                            <div class="card-title">Sales vs Profit (Pareto)</div>
                            <div class="chart-container"><canvas id="chart-combo"></canvas></div>
                        </div>
                        <div class="card span-2 h-chart">
                            <div class="card-title">Discount by Region</div>
                            <div class="chart-container"><canvas id="chart-radar"></canvas></div>
                        </div>
                    </div>
                </div>

                <!-- 2. SALES VIEW -->
                <div id="view-sales" class="view-section" style="display:none;">
                    <div class="dashboard-grid">
                        <div class="card span-4 h-chart">
                            <div class="card-title">Customer Profitability Matrix</div>
                            <div class="chart-container"><canvas id="chart-scatter"></canvas></div>
                        </div>
                    </div>
                </div>

                <!-- 3. SHIPPING VIEW -->
                <div id="view-shipping" class="view-section" style="display:none;">
                    <div class="dashboard-grid">
                        <div class="card span-2 h-chart">
                            <div class="card-title">Shipping Cost by Mode</div>
                            <div class="chart-container"><canvas id="chart-ship-mode"></canvas></div>
                        </div>
                        <div class="card span-2 h-chart">
                            <div class="card-title">Shipping Cost vs Sales</div>
                            <div class="chart-container"><canvas id="chart-ship-cost"></canvas></div>
                        </div>
                    </div>
                </div>

                <!-- 4. PRODUCTS VIEW -->
                <div id="view-products" class="view-section" style="display:none;">
                    <div class="dashboard-grid">
                        <div class="card span-4 h-chart">
                            <div class="card-title">Product Category Performance</div>
                            <div class="chart-container"><canvas id="chart-product-bar"></canvas></div>
                        </div>
                    </div>
                </div>

                <!-- DEBUG (Safe at bottom) -->
                <div id="debug-console"
                    style="border-top:1px solid #eee; padding-top:20px; font-family:monospace; font-size:10px; color:#aaa;">
                </div>
            </div>
        </main>
    </div>

    <!-- SCRIPTS -->
    <script src="mock-app.js"></script>
    <script src="connect.js"></script>
    <script src="index.js"></script>
    <script>
        // Simple Console Redirect
        window.log = function (msg) {
            const el = document.getElementById('debug-console');
            if (el) {
                el.innerHTML = `> ${msg}<br>` + el.innerHTML.substring(0, 500); // Keep styling clean
            }
            console.log(msg);
        }
    </script>
</body>

</html>